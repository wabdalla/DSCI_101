---
title: "Final Exam"
author: "YOUR NAME HERE"
date: "2025-05-02"
output: html_document
editor_options: 
  chunk_output_type: console
---


# Final Exam DSCI 101 Spring 2025


### **Instructions**

* Below is your final exam for DSCI 101 for Spring 2025.

* **YOU ARE NOT ALLOWED TO SHARE THE CONTENT OF THIS EXAM WITH ANYONE**

* You may consult your class notes or the help buttons in R. 

* You are only allowed to work within RStudio. Any file you need to access, you should do it within RStudio.

* Make sure to answer in full sentences if you see *YOUR WRITTEN ANSWER HERE* after a question. 

* Answer each question using this same file. Your codes should go inside the codechunks. 

* Once you are done with the exam, you must knit the file and load the html document in Sakai. 

### **Dataset Description: Chocolate Sales**

The dataset, named `chocolate_sales.csv`, contains detailed records of chocolate sales. 

Each row represents a transaction done on a specific date, by a specific sales representative and for a specific country. Below is a description of each column: 

* Date: Date of transaction. 
* Sales_Person: Name of sales representative that performed the transaction. 
* Country: Name of the country for which the order was shipped to.
* Product: Name of the chocolate brand. 
* Boxed_Shipped: Number of boxes shipped for the specific transaction.
* Sales: The number (in dollars) of sales revenue for the specific transaction. 

### **File submitted in HTML Format **

Submit the html file in Sakai once you are done with your exam. If you request help from your instructor to knit the file, you will lose 5 points. 


### **Loading Packages**

```{r packages, message = FALSE, warning = FALSE}
library(tidyverse)
library(plotly)
```

### **Question 1** (20 points)

a. Read in the dataset `chocolate_sales.csv`. Name the dataframe `chocolate`. 

```{r question_1a, message = FALSE, warning = FALSE}



```

b. Check the class of the `Date` column in the code chunks. What class should it be? and why is it not reflecting the correct class?  

*YOUR WRITTEN ANSWER HERE*

```{r question_1b, message = FALSE, warning = FALSE}


```

c. Transform the `Date` column into a variable of class "Date" (make this transformation within the same dataframe and make sure the column is still named `Date`). Once you make the transformation, check within the same code chunks the new class of the column `Date`. 

```{r question_1c, message = FALSE, warning = FALSE}


```

d. Count how many transactions where made on products that contain the word "Choco" in their name. **Your final output should be a printed dataframe with 8 rows and two columns: the product name (that contains the word "Choco") and the number transactions on each product**

```{r question_1d, message = FALSE, warning = FALSE}


```

e. How many total boxes were sold by "Andria Kimpton" (Sales_Person) on each one of the Countries? **Your final output should be a printed dataframe with six rows and two columns: the country and the total number of boxes per country sold by the specific sales person.**

```{r question_1e, message = FALSE, warning = FALSE}


```



### **Question 2** (20 points)

a. Create a new function called `continent_function` such that it's argument is a `country_name`. If the country is Australia, New Zealand, or India then the function will return "Oceania or Asia". If the country is Canada, USA, or UK then the function will return "North America or Europe". 

After creating the function, test the function (individually) with Australia, Canada, India, and UK.

***Note: Make sure that the names of the countries in the function are spelled as mentioned on the instructions*** 


```{r question_2a, message = FALSE, warning = FALSE}


```

b. Apply the function you created in part a to the `chocolate` dataframe using the `map_chr` function (or any other function in the `map` family). Then calculate how many transactions per continent there were. ***Your final output should be a printed dataframe with two columns and two rows that shows you the continents and the number of transactions in each continent***   

```{r question_2b, message = FALSE, warning = FALSE}


```


### **Question 3** (20 points)

Recreate Plot # 1 - Plotly Graph. Recreating this interactive plot will require data wrangling, pivoting, and proper labeling. Follow the following parts to be able to recreate the plot: 

a. Using the `chocolate` dataframe, select columns `Date`, `Country`, and `Sales`. Save it into a new dataframe. **Do not print the dataframe**

```{r question_3a, message = FALSE, warning = FALSE}


```


b. Using the dataframe created in part a. For each row, extract the month in numeric form (i.e., 1, 2, 3, ... etc.). Then compute the total number of sales per country and month. **Do not print the dataframe**  

```{r question_3b, message = FALSE, warning = FALSE}


```

c. Reshape the dataframe from part b into a wide format, such that the first column is `Month`, the second column is `Australia`, the third column is `Canada`... etc. The core of the table should reflect the total number of sales for the respective month and country. Save this into a dataframe. **Do not print the dataframe**  

```{r question_3c, message = FALSE, warning = FALSE}


```


d. Using the dataframe created in part c, recreate Plot # 1 using the function `plot_ly.` **Your final output should be a printed interactive plot**

```{r question_3d, message = FALSE, warning = FALSE}


```

### **Question 4** (20 points)

Use the `Sales_Person` column and take the sales from "Jehu Rudeforth" as a sample and perform a bootstrap analysis. Estimate the standard error of the **mean**. Perform 1000 iterations.

Note: You can turn a column of a datafame into a vector by using the following code `dataframe$column_name`. **Your final output should be the printed value of the estimated standard error.**

```{r question_4, message = FALSE, warning = FALSE}


```

### **Question 5** (20 points)

Suppose a company is selling 10 tickets for a raffle. Jane bought 2 tickets, John bought 3 tickets, Sarah bought 1 ticket and Peter bought 4 tickets.     

If you randomly draw one of those raffle tickets, the theoretical probability that the winner is Sarah is 1/10 (0.1). 

Create a function that simulates drawing one raffle ticket. The arguments of the function should be `i`, `all_raffle_tickets`, and `person_name`, representing the iterations, the vector of all raffle tickets, and the name of the person you want to compute the probability on, respectively. 

Use this function along with one of the `map` family functions to simulate the experimental probability of Sarah winning the raffle. Use 1000 iterations. 

**Your final output should be the printed experimental probability of Sarah winning the raffle.**

 
```{r question_5, message = FALSE, warning = FALSE}





```

### **Extra Credit** (5 points)

Open a new R script file and recreate the shiny app EXACTLY as it is. The dataframe used to create the scatter plot is `mtcars`. If you decide to do this for extra credit, you can upload this R script along with your html file. 

No credit will be give if your app does not run. 

