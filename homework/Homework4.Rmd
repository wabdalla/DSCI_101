---
title: "Homework 4"
author: "Your Name Here"
date: "2024-02-24"
output: html_document
editor_options: 
  chunk_output_type: console
---

### **Instructions**

Use functions learned from the tidyverse package to complete this homework assignment. Load all the packages you will use throughout this homework in the loading packages section below.


Submit the html file in Sakai before the deadline.


### **Loading Packages**

(5 points)

```{r packages, message=FALSE}
library(tidyverse)
library(Lahman)
library(nycflights13)
```

### **Exercise 1**

Use the `Batting`, `Pitching`, and `People` tables in the Lahman package to answer the following questions:

a) (20 points) Name every player (first and last name) in baseball history who has accumulated across their careers at least 300 home runs (HR) AND at least 300 stolen bases (SB). You can find the first and last name of the player in the `People` data frame. Join this to your result along with the total home runs and total bases stolen for each of these elite players.
***Your final output should be a printed dataframe that has four columns reflecting the players' first name and last name and the total homeruns and total stolen bases***


```{r ex1a, message = FALSE}
data("Batting")
data("People")

question_1a <- Batting %>%
  group_by(playerID) %>%
  summarize(Total_HR = sum(HR), 
            Total_SB = sum(SB)) %>%
  filter(Total_HR>=300 & Total_SB>=300) %>%
  left_join(People, by = c("playerID"="playerID")) %>%
  select(nameFirst, nameLast, Total_HR, Total_SB)

question_1a
```


b) (20 points) Similarly, name every pitcher (first and last name) in baseball history who has accumulated at least 300 wins (W) and at least 4,000 strikeouts (SO). ***Your final output should be a printed dataframe that has four columns reflecting the players' first name and last name and the total wins and total strikeouts***

```{r ex1b, message = FALSE}
data("Pitching")

question_1b <- Pitching %>%
  group_by(playerID) %>%
  summarize(Total_W = sum(W), 
            Total_SO = sum(SO)) %>%
  filter(Total_W >= 300 & Total_SO >= 4000) %>%
  left_join(People, by = c("playerID"="playerID")) %>%
  select(nameFirst, nameLast, Total_W, Total_SO)

question_1b
```

c) (20 points) Identify the name of the players who have hit at least 50 home runs in a single season. Of those players, which player had the lowest batting average (hits/at bats [H/AB])? ***Your final output should be a printed dataframe that has five columns reflecting the player's first name, last name, the year of the season, the number of homeruns, and the batting average (H/AB)***

```{r ex1c, message = FALSE}
question_1c <- Batting %>%
  filter(HR>=50) %>%
  mutate(H_AB = H/AB) %>%
  left_join(People, by = "playerID")%>%
  filter(H_AB == min(H_AB)) %>%
  select(nameFirst, nameLast, yearID, HR, H_AB)

question_1c
```

### **Exercise 2**

Use the nycflights13 package and the `flights` and `planes` tables to answer the following questions:

a) (15 points) What is the oldest plane (specified by the tailnum variable) that flew from New York City airports in 2013 and how many flights did this plane conduct from New York City airports in 2013? ***Your final output should be a printed dataframe that has three columns reflecting the tailnumber of the plane, the year it was manufactured, and the number of flights this plane conducted from NYC***


```{r ex2a, message = FALSE}
data("flights")
data("planes")

question_2a <- flights %>%
  left_join(planes, by = "tailnum") %>%
  filter(year.y == min(year.y, na.rm = TRUE)) %>%
  group_by(tailnum, year.y) %>%
  summarize(Number_Flights = n())

question_2a
```

b) (10 points) How many ***different*** airplanes (specified by the tailnum) are in the `flights` dataset? How many ***different*** airplanes (specified by the tailnum) are in the `planes` dataset? 

*YOUR WRITTEN ANSWER HERE*

*There are 4044 different airplanes in the flights dataset. There are 3322 different airplanes in the planes dataset.*

```{r ex2b, message = FALSE}
n_distinct(flights$tailnum)
n_distinct(planes$tailnum)
```

c) (10 points) In 2013, there were 336,776 flights that left New York City, how many of those airplanes are included in the planes table? What does this imply if we do an inner_join with the `flights` and `planes` dataset by `tailnum`? (You don't need to do an inner join, simply explain the implication).

*YOUR WRITTEN ANSWER HERE*

*There are 284,170 airplanes in the planes table. Inner joining flights and planes by tailnum will only keep those planes in common by both dataset and the flights dataset will be reduced*

```{r ex2c, message = FALSE}
table(flights$tailnum %in% planes$tailnum)
```